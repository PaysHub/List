<!DOCTYPE html>
<html>
<head>
  <title>Payment Systems</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
      background-color: #1a1a1a;
      color: #ffffff;
      overflow-x: hidden;
    }
    .content-container {
      width: 100%;
      position: relative;
      transition: filter 0.3s ease;
    }
    .content-container.blurred {
      filter: blur(5px) brightness(0.5);
    }
    .header-section {
      background: linear-gradient(135deg, #1a2a44, #1a3c34);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      margin: 30px 15px;
    }
    .header-section h1 {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 10px;
      background: linear-gradient(90deg, #007bff, #00c4b4, #007bff);
      background-size: 200% 100%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: gradientShift 3s infinite linear;
    }
    .header-section .subtitle {
      font-size: 20px;
      color: #ddd;
      margin-bottom: 20px;
    }
    .header-section .stats {
      display: flex;
      justify-content: space-around;
      margin-bottom: 20px;
    }
    .header-section .stat {
      text-align: center;
    }
    .header-section .stat h3 {
      font-size: 14px;
      font-weight: 500;
      color: #aaa;
      margin-bottom: 5px;
    }
    .header-section .stat p {
      font-size: 24px;
      font-weight: 600;
      color: #fff;
      margin: 0;
    }
    .slider-container {
      position: relative;
      width: 100%;
      margin: 30px 15px;
      overflow: hidden;
    }
    .slider {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding-bottom: 10px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: none;
      scrollbar-width: none;
      padding-left: 15px;
      padding-right: 15px;
    }
    .slider::-webkit-scrollbar {
      display: none;
    }
    .slide {
      flex: 0 0 calc(100% - 30px);
      height: 200px;
      background: #333;
      border-radius: 12px;
      padding: 15px;
      box-sizing: border-box;
      display: flex;
      align-items: center;
      justify-content: space-between;
      scroll-snap-align: start;
    }
    .slide .content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      text-align: left;
      margin-right: 15px;
    }
    .slide h3 {
      font-size: 18px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 10px;
    }
    .slide p {
      font-size: 14px;
      color: #ddd;
      margin-bottom: 15px;
    }
    .slide .apply-button {
      padding: 10px;
      background: #007bff;
      border: none;
      border-radius: 8px;
      color: #fff;
      font-weight: 500;
      cursor: pointer;
      text-align: center;
      width: 100%;
      max-width: 200px;
      transition: background 0.3s;
    }
    .slide .apply-button:hover {
      background: #0056b3;
    }
    .slide .image {
      flex: 0 0 120px;
      height: 120px;
      background-size: cover;
      background-position: center;
      border-radius: 50%;
    }
    .slider-dots {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 10px;
      margin-bottom: 15px;
      padding-right: 30px;
    }
    .dot {
      width: 8px;
      height: 8px;
      background: #555;
      border-radius: 50%;
      cursor: pointer;
    }
    .dot.active {
      background: #007bff;
    }
    .slider::after {
      content: '';
      flex: 0 0 15px;
    }
    /* Новые блоки "С кем мы работаем" */
    .partners-section {
      margin: 30px 15px;
    }
    .partners-section .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 15px;
      position: relative;
      display: inline-block;
    }
    .partners-section .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, #007bff, #00c4b4);
      transition: width 0.3s ease;
    }
    .partners-grid {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding-bottom: 10px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .partners-grid::-webkit-scrollbar {
      display: none;
    }
    .partner-block {
      flex: 0 0 250px;
      background: linear-gradient(135deg, #1a2a44, #1a3c34);
      border-radius: 12px;
      padding: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      scroll-snap-align: start;
    }
    .partner-block.low-risk {
      background: linear-gradient(135deg, #1a3c34, #2a5c44);
    }
    .partner-block.medium-risk {
      background: linear-gradient(135deg, #1a2a44, #2a5c44);
    }
    .partner-block.high-risk {
      background: linear-gradient(135deg, #1a2a44, #1a3c34);
    }
    .partner-block .emoji {
      font-size: 24px;
    }
    .partner-block p {
      font-size: 14px;
      color: #fff;
      margin: 0;
    }
    /* Блок "Ставки" */
    .latest-rates {
      margin: 30px 15px;
    }
    .latest-rates .header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }
    .latest-rates .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #fff;
      position: relative;
      display: inline-block;
      cursor: pointer;
    }
    .latest-rates .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, #007bff, #00c4b4);
      transition: width 0.3s ease;
    }
    .latest-rates .section-title:hover::after {
      width: 50%;
    }
    .latest-rates .see-all-button {
      display: inline-block;
      padding: 8px 15px;
      border: 1px solid #fff;
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      transition: background 0.3s, color 0.3s;
    }
    .latest-rates .see-all-button:hover {
      background: linear-gradient(90deg, #007bff, #00c4b4);
      color: #fff;
      border-color: transparent;
    }
    .latest-rates .section-subtitle {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 15px;
    }
    .rates-cards-container {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding-bottom: 10px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      max-width: 100%;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .rates-cards-container::-webkit-scrollbar {
      display: none;
    }
    .rate-card {
      flex: 0 0 250px;
      background: #2a2a2a;
      border-radius: 12px;
      scroll-snap-align: start;
      transition: transform 0.3s ease;
    }
    .rate-card:hover {
      transform: scale(1.02);
    }
    .rate-card .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 16px;
      padding: 10px 15px;
    }
    .rate-card .card-tags {
      margin-top: 5px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      padding: 0 15px;
      margin-bottom: 10px;
    }
    .rate-card .tag {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      color: #fff;
      background: #333; /* Серый фон для остальных тегов */
    }
    .rate-card .tag.service {
      background: linear-gradient(90deg, #007bff, #00c4b4, #007bff); /* Переливающийся градиент для первого тега */
      background-size: 200% 100%;
      animation: gradientShift 3s infinite linear;
    }
    /* Блок "Решения" */
    .latest-tech {
      margin: 30px 15px;
    }
    .latest-tech .header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }
    .latest-tech .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #fff;
      position: relative;
      display: inline-block;
      cursor: pointer;
    }
    .latest-tech .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, #007bff, #00c4b4);
      transition: width 0.3s ease;
    }
    .latest-tech .section-title:hover::after {
      width: 50%;
    }
    .latest-tech .see-all-button {
      display: inline-block;
      padding: 8px 15px;
      border: 1px solid #fff;
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      transition: background 0.3s, color 0.3s;
    }
    .latest-tech .see-all-button:hover {
      background: linear-gradient(90deg, #007bff, #00c4b4);
      color: #fff;
      border-color: transparent;
    }
    .latest-tech .section-subtitle {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 15px;
    }
    .tech-cards-container {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding-bottom: 10px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      max-width: 100%;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .tech-cards-container::-webkit-scrollbar {
      display: none;
    }
    .tech-card {
      flex: 0 0 250px;
      background: #2a2a2a;
      border-radius: 12px;
      overflow: hidden;
      scroll-snap-align: start;
      transition: transform 0.3s ease;
    }
    .tech-card:hover {
      transform: scale(1.02);
    }
    .tech-card img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      transition: transform 0.3s ease;
    }
    .tech-card:hover img {
      transform: scale(1.05);
    }
    .tech-card .card-header {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      font-weight: 600;
      font-size: 16px;
      padding: 10px 15px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .tech-card .card-header .price {
      font-size: 14px;
      color: #aaa;
      margin-top: 4px;
    }
    .tech-card .card-tags {
      margin-top: 5px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      padding: 0 15px;
      margin-bottom: 10px;
    }
    .tech-card .tag {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      color: #fff;
      background: linear-gradient(90deg, #007bff, #00c4b4);
    }
    /* Блок "ИИ-ассистент" */
    .ai-assistant {
      background: #2a2a2a;
      border-radius: 12px;
      padding: 20px;
      margin: 30px 15px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    .ai-assistant .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 5px;
      position: relative;
      display: inline-block;
    }
    .ai-assistant .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, #007bff, #00c4b4);
      transition: width 0.3s ease;
    }
    .ai-assistant .section-subtitle {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 15px;
    }
    .ai-assistant .description {
      font-size: 14px;
      color: #ddd;
      margin-bottom: 15px;
      line-height: 1.5;
    }
    .ai-assistant .try-button {
      display: inline-block;
      padding: 8px 15px;
      border: 1px solid #fff;
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      transition: background 0.3s, color 0.3s;
    }
    .ai-assistant .try-button:hover {
      background: linear-gradient(90deg, #007bff, #00c4b4);
      color: #fff;
      border-color: transparent;
    }
    /* Блок "Для агентов" */
    .for-agents {
      background: #2a2a2a;
      border-radius: 12px;
      padding: 20px;
      margin: 30px 15px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    .for-agents .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 5px;
      position: relative;
      display: inline-block;
    }
    .for-agents .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, #007bff, #00c4b4);
      transition: width 0.3s ease;
    }
    .for-agents .section-subtitle {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 15px;
    }
    .for-agents .description {
      font-size: 14px;
      color: #ddd;
      margin-bottom: 15px;
      line-height: 1.5;
    }
    .for-agents .agent-button {
      display: inline-block;
      padding: 8px 15px;
      border: 1px solid #fff;
      border-radius: 8px;
      background: transparent;
      color: #fff;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      transition: background 0.3s, color 0.3s;
      cursor: pointer;
    }
    .for-agents .agent-button:hover {
      background: linear-gradient(90deg, #007bff, #00c4b4);
      color: #fff;
      border-color: transparent;
    }
    /* Блок "Ресурсы" */
    .info-section {
      background: #2a2a2a;
      border-radius: 12px;
      padding: 20px;
      margin: 30px 15px;
    }
    .info-section h3 {
      font-size: 18px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 15px;
    }
    .resources {
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }
    .resource-button {
      flex: 1;
      background: linear-gradient(90deg, #007bff, #00c4b4);
      border-radius: 8px;
      padding: 15px;
      text-align: center;
      text-decoration: none;
      color: #fff;
      font-size: 14px;
      font-weight: 500;
      transition: transform 0.3s ease;
    }
    .resource-button:hover {
      transform: scale(1.02);
    }
    /* Стили для попапов форм */
    .feedback-popup,
    .add-psp-popup,
    .invest-popup,
    .agent-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.95);
      width: 80%;
      max-height: 70vh;
      background: #2a2a2a;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
      display: none;
      z-index: 30;
      overflow-y: auto;
      opacity: 0;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    .feedback-popup.active,
    .add-psp-popup.active,
    .invest-popup.active,
    .agent-popup.active {
      display: block;
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
    .feedback-popup h4,
    .add-psp-popup h4,
    .invest-popup h4,
    .agent-popup h4 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
      color: #fff;
    }
    .feedback-instruction,
    .add-psp-instruction,
    .invest-instruction,
    .agent-instruction {
      font-size: 13px;
      color: #ddd;
      background: #333;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 15px;
      line-height: 1.5;
    }
    .feedback-form,
    .add-psp-form,
    .invest-form,
    .agent-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .feedback-form input,
    .add-psp-form input,
    .invest-form input,
    .agent-form input,
    .feedback-form textarea,
    .add-psp-form textarea,
    .invest-form textarea,
    .agent-form textarea {
      padding: 8px;
      border: 1px solid #555;
      border-radius: 8px;
      background: #333;
      color: #fff;
      font-size: 14px;
      outline: none;
      resize: none;
    }
    .feedback-form textarea,
    .add-psp-form textarea,
    .invest-form textarea,
    .agent-form textarea {
      height: 100px;
    }
    .popup-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    .popup-button {
      flex: 1;
      padding: 8px;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      font-size: 14px;
      color: #fff;
    }
    .popup-button.submit {
      background: #007bff;
    }
    .popup-button.cancel {
      background: #555;
    }
    /* Стили для уведомления */
    .notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #2a2a2a;
      border-radius: 8px;
      padding: 15px;
      color: #fff;
      font-size: 14px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
      z-index: 40;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .notification.active {
      opacity: 1;
    }
    @keyframes gradientShift {
      0% { background-position: 0% 0%; }
      100% { background-position: 200% 0%; }
    }
    @media (max-width: 600px) {
      .header-section h1 { font-size: 24px; }
      .header-section .subtitle { font-size: 18px; }
      .header-section .stat h3 { font-size: 12px; }
      .header-section .stat p { font-size: 20px; }
      .slide h3 { font-size: 16px; }
      .slide p { font-size: 13px; }
      .slide .apply-button { max-width: none; }
      .slide .image { flex: 0 0 100px; height: 100px; }
      .latest-rates .section-title { font-size: 18px; }
      .latest-rates .section-subtitle { font-size: 13px; }
      .rate-card { flex: 0 0 200px; }
      .rate-card .card-header { font-size: 14px; }
      .latest-tech .section-title { font-size: 18px; }
      .latest-tech .section-subtitle { font-size: 13px; }
      .tech-card { flex: 0 0 200px; }
      .tech-card img { height: 120px; }
      .tech-card .card-header { font-size: 14px; }
      .ai-assistant .section-title { font-size: 18px; }
      .ai-assistant .section-subtitle { font-size: 13px; }
      .ai-assistant .description { font-size: 13px; }
      .for-agents .section-title { font-size: 18px; }
      .for-agents .section-subtitle { font-size: 13px; }
      .for-agents .description { font-size: 13px; }
      .info-section h3 { font-size: 16px; }
      .resources { flex-direction: column; }
      .resource-button { font-size: 13px; }
      .feedback-popup, .add-psp-popup, .invest-popup, .agent-popup { width: 90%; }
      .feedback-form input, .add-psp-form input, .invest-form input, .agent-form input,
      .feedback-form textarea, .add-psp-form textarea, .invest-form textarea, .agent-form textarea { font-size: 12px; }
      .popup-button { font-size: 12px; }
      .feedback-instruction, .add-psp-instruction, .invest-instruction, .agent-instruction { font-size: 12px; }
      .partner-block { flex: 0 0 200px; }
      .partner-block p { font-size: 13px; }
      .notification { font-size: 12px; padding: 10px; }
    }
  </style>
</head>
<body>
  <div class="content-container">
    <div class="header-section">
      <h1>PaysHub</h1>
      <div class="subtitle">Агрегатор платежных решений</div>
      <div class="stats">
        <div class="stat">
          <h3>PSP</h3>
          <p>20+</p>
        </div>
        <div class="stat">
          <h3>Решений</h3>
          <p>50+</p>
        </div>
        <div class="stat">
          <h3>Партнеров</h3>
          <p>1000+</p>
        </div>
      </div>
    </div>

    <div class="slider-container">
      <div class="slider" id="intro-slider">
        <div class="slide">
          <div class="content">
            <h3>Для клиентов</h3>
            <p>Подбираем оптимальные платёжные системы для бизнеса любого уровня (low & high).</p>
            <button class="apply-button" onclick="openFeedbackPopup()">Оставить запрос</button>
          </div>
          <div class="image" style="background-image: url('https://github.com/PaysHub/List/raw/main/images/s1.png');"></div>
        </div>
        <div class="slide">
          <div class="content">
            <h3>Для платёжек и банков</h3>
            <p>Объединяем PSP, банки и финтех в B2B-коллаборации. Продажа и аренда готовых технических решений и White Label.</p>
            <button class="apply-button" onclick="openAddPspPopup()">Добавить PSP</button>
          </div>
          <div class="image" style="background-image: url('https://github.com/PaysHub/List/raw/main/images/s2.png');"></div>
        </div>
        <div class="slide">
          <div class="content">
            <h3>Инвестиции</h3>
            <p>Привлекаем капитал для масштабирования платёжных систем – лицензии, новые регионы, ликвидность – за долю в компании.</p>
            <button class="apply-button" onclick="openInvestPopup()">Подробнее</button>
          </div>
          <div class="image" style="background-image: url('https://github.com/PaysHub/List/raw/main/images/s3.png');"></div>
        </div>
      </div>
      <div class="slider-dots" id="slider-dots"></div>
    </div>

    <!-- Новые блоки "С кем мы работаем" -->
    <div class="partners-section">
      <div class="section-title">Кто наши клиенты</div>
      <div class="partners-grid">
        <div class="partner-block">
          <span class="emoji">🏬</span>
          <p>Работаем с традиционными бизнесами: e-commerce, ритейл, услуги.</p>
        </div>
        <div class="partner-block low-risk">
          <span class="emoji">🛡️</span>
          <p>Поддерживаем бизнесы с низким риском: SaaS, образование, благотворительность.</p>
        </div>
        <div class="partner-block medium-risk">
          <span class="emoji">📈</span>
          <p>Решения для бизнесов среднего риска: финтех, туризм, подписки.</p>
        </div>
        <div class="partner-block high-risk">
          <span class="emoji">⚡</span>
          <p>Работаем с высокорисковыми бизнесами: гемблинг, крипта, дейтинг.</p>
        </div>
      </div>
    </div>

    <!-- Блок "Ставки" -->
    <div class="latest-rates">
      <div class="header-row">
        <div class="section-title">Ставки</div>
        <a href="#" class="see-all-button">Все</a>
      </div>
      <div class="section-subtitle">Самые актуальные предложения по ставкам</div>
      <div class="rates-cards-container" id="rates-content">
        <p>Загрузка...</p>
      </div>
    </div>

    <!-- Блок "Решения" -->
    <div class="latest-tech">
      <div class="header-row">
        <div class="section-title">Решения</div>
        <a href="#" class="see-all-button">Все</a>
      </div>
      <div class="section-subtitle">Инновационные технологии для вашего бизнеса</div>
      <div class="tech-cards-container" id="tech-content">
        <p>Загрузка...</p>
      </div>
    </div>

    <!-- Блок "ИИ-ассистент" -->
    <div class="ai-assistant">
      <div class="section-title">ИИ-ассистент для вашего бизнеса</div>
      <div class="section-subtitle">Автоматизируйте подбор решений с помощью ИИ</div>
      <div class="description">
        Наш ИИ-ассистент анализирует ваши потребности и подбирает оптимальные платёжные решения за секунды.
      </div>
      <a href="#" class="try-button">Попробовать ИИ-ассистента →</a>
    </div>

    <!-- Блок "Для агентов" -->
    <div class="for-agents">
      <div class="section-title">Для агентов</div>
      <div class="section-subtitle">Зарабатывайте с нами</div>
      <div class="description">
        Присоединяйтесь к нашей партнёрской программе и получайте доход за привлечение клиентов.
      </div>
      <button class="agent-button" onclick="openAgentPopup()">Стать агентом →</button>
    </div>

    <div class="info-section">
      <h3>Ресурсы:</h3>
      <div class="resources">
        <a href="https://t.me/pays_hub" target="_blank" class="resource-button">Канал @pays_hub</a>
        <a href="https://t.me/p_fintech" target="_blank" class="resource-button">Оператор @p_fintech</a>
      </div>
    </div>
  </div>

  <!-- Попап формы подбора PSP -->
  <div class="feedback-popup" id="feedback-popup">
    <h4>Запрос на подбор PSP</h4>
    <div class="feedback-instruction">
      Оставьте заявку, и мы подберем платежное решение. Укажите:<br>
      - Объем платежей в месяц<br>
      - Адрес сайта<br>
      - Методы платежей (карты, P2P, крипта и т.д.)<br>
      - Есть ли юрлицо (где зарегистрировано)
    </div>
    <form class="feedback-form" id="feedback-form">
      <input type="text" id="feedback-telegram" placeholder="Ваш Telegram-ник или телефон" required>
      <textarea id="feedback-message" placeholder="Ответы на вопросы" required></textarea>
      <div class="popup-actions">
        <button type="submit" class="popup-button submit">Отправить</button>
        <button type="button" class="popup-button cancel" onclick="closeFeedbackPopup()">Закрыть</button>
      </div>
    </form>
  </div>

  <!-- Попап формы добавления PSP -->
  <div class="add-psp-popup" id="add-psp-popup">
    <h4>Добавление PSP в список</h4>
    <div class="add-psp-instruction">
      Оставьте заявку, чтобы добавить вашу платежную систему в список. Укажите:<br>
      - Название PSP<br>
      - Сайт<br>
      - Контакт для связи (Telegram)<br>
      - Тип платежей (Low-risk, High-risk, Криптовалюта, Карты и т.д.)<br>
      - Доступные страны<br>
      - Валюта расчетов<br>
      - Комиссия (фиксированная или %)<br>
      - API-документация (если есть)
    </div>
    <form class="add-psp-form" id="add-psp-form">
      <input type="text" id="add-psp-telegram" placeholder="Ваш Telegram-ник или телефон" required>
      <textarea id="add-psp-message" placeholder="Ответы на вопросы" required></textarea>
      <div class="popup-actions">
        <button type="submit" class="popup-button submit">Отправить</button>
        <button type="button" class="popup-button cancel" onclick="closeAddPspPopup()">Закрыть</button>
      </div>
    </form>
  </div>

  <!-- Попап формы для инвестиций -->
  <div class="invest-popup" id="invest-popup">
    <h4>Инвестиции</h4>
    <div class="invest-instruction">
      Мы ищем проекты для инвестиций. Нам интересны:<br>
      - Платёжные системы с лицензиями<br>
      - Проекты в финтехе, крипте, гемблинге<br>
      - Бизнесы с оборотом от $1M в месяц<br>
      - Команды с опытом в индустрии<br>
      Требования:<br>
      - Наличие юрлица<br>
      - Прозрачная финансовая отчётность<br>
      - Готовность к масштабированию<br>
      Оставьте заявку, указав информацию о вашем проекте.
    </div>
    <form class="invest-form" id="invest-form">
      <input type="text" id="invest-telegram" placeholder="Ваш Telegram-ник или телефон" required>
      <textarea id="invest-message" placeholder="Ответы на вопросы" required></textarea>
      <div class="popup-actions">
        <button type="submit" class="popup-button submit">Отправить</button>
        <button type="button" class="popup-button cancel" onclick="closeInvestPopup()">Закрыть</button>
      </div>
    </form>
  </div>

  <!-- Попап формы для агентов -->
  <div class="agent-popup" id="agent-popup">
    <h4>Стать агентом</h4>
    <div class="agent-instruction">
      Оставьте заявку, чтобы стать агентом и зарабатывать с нами. Укажите:<br>
      - Ваш опыт в привлечении клиентов<br>
      - Какие проекты или компании вы представляете<br>
      - Ожидания от сотрудничества
    </div>
    <form class="agent-form" id="agent-form">
      <input type="text" id="agent-telegram" placeholder="Ваш Telegram-ник или телефон" required>
      <textarea id="agent-message" placeholder="Ответы на вопросы" required></textarea>
      <div class="popup-actions">
        <button type="submit" class="popup-button submit">Отправить</button>
        <button type="button" class="popup-button cancel" onclick="closeAgentPopup()">Закрыть</button>
      </div>
    </form>
  </div>

  <!-- Уведомление об отправке -->
  <div class="notification" id="notification">Сообщение успешно отправлено!</div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    const API_TOKEN = 'ubicp2nFx8L47YOV3MOyn1FhUIPQ4EMESzFnrL3L';
    const BASE_URL = 'https://app.nocodb.com/api/v2/tables/';
    const RATES_TABLE_ID = 'mbz9kdbkba6i9t2';
    const TECH_TABLE_ID = 'mnliw8pc7zmrw35';

    let ratesData = [];
    let techData = [];

    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const dotsContainer = document.getElementById('slider-dots');
    const slider = document.getElementById('intro-slider');

    // Подставляем Telegram-ник в поля при открытии форм
    const telegramUser = tg.initDataUnsafe.user;
    const telegramUsername = telegramUser ? telegramUser.username : '';

    // Создаем точки навигации
    slides.forEach((_, index) => {
      const dot = document.createElement('div');
      dot.className = 'dot';
      dot.addEventListener('click', () => {
        currentSlide = index;
        updateSlider();
      });
      dotsContainer.appendChild(dot);
    });

    const dots = document.querySelectorAll('.dot');
    dots[0].classList.add('active');

    // Функция обновления точек навигации при скролле
    function updateSliderDots() {
      const slideWidth = slides[0].offsetWidth + 15; // Ширина слайда + gap
      const scrollPosition = slider.scrollLeft;
      const newSlideIndex = Math.round(scrollPosition / slideWidth);
      currentSlide = Math.max(0, Math.min(slides.length - 1, newSlideIndex));

      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentSlide);
      });
    }

    // Обновляем точки при скролле
    slider.addEventListener('scroll', updateSliderDots);

    // Функция для показа уведомления
    function showNotification(message) {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.classList.add('active');
      setTimeout(() => {
        notification.classList.remove('active');
      }, 3000);
    }

    // Функции для попапов форм
    function openFeedbackPopup() {
      const popup = document.getElementById('feedback-popup');
      const telegramField = document.getElementById('feedback-telegram');
      telegramField.value = telegramUsername ? `@${telegramUsername}` : '';
      popup.classList.add('active');
      document.querySelector('.content-container').classList.add('blurred');
    }

    function closeFeedbackPopup() {
      const popup = document.getElementById('feedback-popup');
      popup.classList.remove('active');
      document.querySelector('.content-container').classList.remove('blurred');
    }

    function openAddPspPopup() {
      const popup = document.getElementById('add-psp-popup');
      const telegramField = document.getElementById('add-psp-telegram');
      telegramField.value = telegramUsername ? `@${telegramUsername}` : '';
      popup.classList.add('active');
      document.querySelector('.content-container').classList.add('blurred');
    }

    function closeAddPspPopup() {
      const popup = document.getElementById('add-psp-popup');
      popup.classList.remove('active');
      document.querySelector('.content-container').classList.remove('blurred');
    }

    function openInvestPopup() {
      const popup = document.getElementById('invest-popup');
      const telegramField = document.getElementById('invest-telegram');
      telegramField.value = telegramUsername ? `@${telegramUsername}` : '';
      popup.classList.add('active');
      document.querySelector('.content-container').classList.add('blurred');
    }

    function closeInvestPopup() {
      const popup = document.getElementById('invest-popup');
      popup.classList.remove('active');
      document.querySelector('.content-container').classList.remove('blurred');
    }

    function openAgentPopup() {
      const popup = document.getElementById('agent-popup');
      const telegramField = document.getElementById('agent-telegram');
      telegramField.value = telegramUsername ? `@${telegramUsername}` : '';
      popup.classList.add('active');
      document.querySelector('.content-container').classList.add('blurred');
    }

    function closeAgentPopup() {
      const popup = document.getElementById('agent-popup');
      popup.classList.remove('active');
      document.querySelector('.content-container').classList.remove('blurred');
    }

    // Предотвращаем исчезновение блюра при фокусе на полях ввода
    document.querySelectorAll('input, textarea').forEach(input => {
      input.addEventListener('focus', () => {
        document.querySelector('.content-container').classList.add('blurred');
      });
      input.addEventListener('blur', () => {
        if (!document.querySelector('.feedback-popup.active') &&
            !document.querySelector('.add-psp-popup.active') &&
            !document.querySelector('.invest-popup.active') &&
            !document.querySelector('.agent-popup.active')) {
          document.querySelector('.content-container').classList.remove('blurred');
        }
      });
    });

    // Функция для получения данных из NocoDB
    async function fetchData(tableId) {
      try {
        console.log(`Fetching data for table ${tableId}...`);
        console.log(`Using API_TOKEN: ${API_TOKEN}`);
        console.log(`Request URL: ${BASE_URL}${tableId}/records?offset=0&limit=100`);
        const response = await fetch(`${BASE_URL}${tableId}/records?offset=0&limit=100`, {
          headers: {
            'xc-token': API_TOKEN
          }
        });
        console.log(`Response status for table ${tableId}: ${response.status}`);
        if (!response.ok) {
          const errorText = await response.text();
          console.error(`HTTP error for table ${tableId}! Status: ${response.status}, Response: ${errorText}`);
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        const data = await response.json();
        console.log(`Raw API response for table ${tableId}:`, data);
        const records = data.list || [];
        console.log(`Extracted records for table ${tableId}:`, records);
        return records;
      } catch (error) {
        console.error(`Ошибка при получении данных для tableId ${tableId}:`, error);
        return [];
      }
    }

    async function extractImageUrl(imgField) {
      console.log('Processing Img field:', imgField);

      if (!imgField) {
        console.log('Img field is empty or undefined');
        return 'https://placehold.co/400x276';
      }

      if (typeof imgField === 'string') {
        if (imgField.startsWith('http://') || imgField.startsWith('https://')) {
          if (imgField.includes('raw.githubusercontent.com')) {
            console.log('GitHub raw image URL detected:', imgField);
          } else {
            console.log('Direct image URL detected:', imgField);
          }
          return imgField;
        }
        const match = imgField.match(/\((https:\/\/[^\)]+)\)/);
        if (match) {
          const imageUrl = match[1];
          console.log('Extracted image URL from string (NocoDB format):', imageUrl);
          const urlWithToken = `${imageUrl}?xc-token=${API_TOKEN}`;
          console.log('Image URL with token:', urlWithToken);
          return urlWithToken;
        }
      }

      if (Array.isArray(imgField) && imgField.length > 0) {
        const imageObj = imgField[0];
        console.log('Image object (NocoDB attachment):', imageObj);
        const imageUrl = imageObj.url;
        console.log('Extracted image URL from array:', imageUrl);
        if (imageUrl) {
          const urlWithToken = `${imageUrl}?xc-token=${API_TOKEN}`;
          console.log('Image URL with token:', urlWithToken);
          return urlWithToken;
        }
      }

      console.log('Could not extract image URL, returning placeholder');
      return 'https://placehold.co/400x276';
    }

    function getTags(row, field) {
      return row[field] ? row[field].split(',').map(tag => tag.trim()) : [];
    }

    // Функция для проверки, является ли значение пустым
    function isEmptyValue(value) {
      return !value || value === 'N/A' || value.trim() === '';
    }

    // Функция для форматирования текста (замена переносов строк на <br>)
    function formatText(text) {
      if (!text) return '';
      return text.replace(/\n/g, '<br>');
    }

    // Функция для сокращения текста с добавлением троеточия
    function truncateText(text, maxLength) {
      if (!text) return '';
      if (text.length <= maxLength) return text;
      return text.substring(0, maxLength) + '...';
    }

    function renderRates(containerId, rows) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';

      // Фильтруем строки, показывая только те, у которых On = true и HB = true
      let filteredRows = rows.filter(row => row['On'] === true && row['HB'] === true);

      if (filteredRows.length === 0) {
        container.innerHTML = '<p>Нет данных для отображения. Проверьте, есть ли записи с On=true и HB=true в таблице mbz9kdbkba6i9t2.</p>';
        return;
      }

      filteredRows.forEach(row => {
        const card = document.createElement('div');
        card.className = 'rate-card';

        card.innerHTML = `
          <div class="card-header">
            <span>${row['ID Name'] || 'Без названия'}</span>
            <span>${row['Pay in (%)'] || ''}</span>
          </div>
          <div class="card-tags">
            <span class="tag service">${row['Service'] || 'N/A'}</span>
            ${getTags(row, 'Industry').slice(0, 1).map(tag => `<span class="tag">${tag}</span>`).join('')}
            ${getTags(row, 'Geo').slice(0, 1).map(tag => `<span class="tag">${tag}</span>`).join('')}
            ${getTags(row, 'Risk').slice(0, 1).map(tag => `<span class="tag">${tag}</span>`).join('')}
          </div>
        `;
        container.appendChild(card);
      });
    }

    async function renderTech(containerId, rows) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';

      // Фильтруем строки, показывая только те, у которых On = true и HB = true
      let filteredRows = rows.filter(row => row['On'] === true && row['HB'] === true);

      if (!filteredRows || filteredRows.length === 0) {
        container.innerHTML = '<p>Данные для "Решения" не загружены. Возможные причины: 1) Таблица mnliw8pc7zmrw35 пуста. 2) Нет записей с On=true и HB=true. Откройте консоль (F12 → Console) и проверьте "Raw API response" и "Loaded techData".</p>';
        return;
      }

      for (const row of filteredRows) {
        console.log('Rendering tech card:', row);
        const imgUrl = await extractImageUrl(row['Img']);
        console.log('Extracted image URL for card:', imgUrl);
        const card = document.createElement('div');
        card.className = 'tech-card';

        // Сокращаем заголовок до 20 символов с троеточием
        const truncatedName = truncateText(row['Name'] || 'Без названия', 20);

        card.innerHTML = `
          <img src="${imgUrl}" alt="Tech Solution" onerror="this.src='https://placehold.co/400x276'; console.log('Failed to load image: ${imgUrl}');">
          <div class="card-header">
            <span>${truncatedName}</span>
            <span class="price">${row['Price'] || ''}</span>
          </div>
          <div class="card-tags">
            <span class="tag">${row['Type'] || 'White Label'}</span>
          </div>
        `;
        container.appendChild(card);
      }
    }

    async function loadData() {
      console.log('Starting to load data...');
      // Загружаем данные для обеих вкладок одновременно
      const [rates, tech] = await Promise.all([
        fetchData(RATES_TABLE_ID),
        fetchData(TECH_TABLE_ID)
      ]);

      ratesData = rates;
      techData = tech;

      console.log('Loaded ratesData:', ratesData);
      console.log('Loaded techData:', techData);

      if (!techData || techData.length === 0) {
        console.log('No tech data loaded. Check TECH_TABLE_ID or table contents.');
      }

      // Рендерим обе вкладки
      renderRates('rates-content', ratesData);
      console.log('Calling renderTech with techData...');
      await renderTech('tech-content', techData);

      console.log('Finished loading data.');
    }

    // Загружаем данные при загрузке страницы
    window.addEventListener('load', () => {
      loadData();
    });

    // Обработка отправки формы подбора PSP
    document.getElementById('feedback-form').addEventListener('submit', (e) => {
      e.preventDefault();

      const telegram = document.getElementById('feedback-telegram').value;
      const message = document.getElementById('feedback-message').value;

      // Формируем текст сообщения
      const text = `Новая заявка на подбор PSP:\n\nTelegram: ${telegram}\nСообщение: ${message}`;
      // Перенаправляем пользователя в Telegram-чат с ботом
      const botUsername = '@PaysHubFeedbackBot';
      const telegramUrl = `https://t.me/${botUsername}?start=${encodeURIComponent(text)}`;
      window.open(telegramUrl, '_blank');

      showNotification('Вы будете перенаправлены в Telegram для отправки заявки.');
      closeFeedbackPopup();
      document.getElementById('feedback-form').reset();
    });

    // Обработка отправки формы добавления PSP
    document.getElementById('add-psp-form').addEventListener('submit', (e) => {
      e.preventDefault();

      const telegram = document.getElementById('add-psp-telegram').value;
      const message = document.getElementById('add-psp-message').value;

      const text = `Новая заявка на добавление PSP:\n\nTelegram: ${telegram}\nСообщение: ${message}`;
      const botUsername = '@PaysHubFeedbackBot';
      const telegramUrl = `https://t.me/${botUsername}?start=${encodeURIComponent(text)}`;
      window.open(telegramUrl, '_blank');

      showNotification('Вы будете перенаправлены в Telegram для отправки заявки.');
      closeAddPspPopup();
      document.getElementById('add-psp-form').reset();
    });

    // Обработка отправки формы для инвестиций
    document.getElementById('invest-form').addEventListener('submit', (e) => {
      e.preventDefault();

      const telegram = document.getElementById('invest-telegram').value;
      const message = document.getElementById('invest-message').value;

      const text = `Новая заявка на инвестиции:\n\nTelegram: ${telegram}\nСообщение: ${message}`;
      const botUsername = '@PaysHubFeedbackBot';
      const telegramUrl = `https://t.me/${botUsername}?start=${encodeURIComponent(text)}`;
      window.open(telegramUrl, '_blank');

      showNotification('Вы будете перенаправлены в Telegram для отправки заявки.');
      closeInvestPopup();
      document.getElementById('invest-form').reset();
    });

    // Обработка отправки формы для агентов
    document.getElementById('agent-form').addEventListener('submit', (e) => {
      e.preventDefault();

      const telegram = document.getElementById('agent-telegram').value;
      const message = document.getElementById('agent-message').value;

      const text = `Новая заявка на участие в партнёрской программе:\n\nTelegram: ${telegram}\nСообщение: ${message}`;
      const botUsername = '@PaysHubFeedbackBot';
      const telegramUrl = `https://t.me/${botUsername}?start=${encodeURIComponent(text)}`;
      window.open(telegramUrl, '_blank');

      showNotification('Вы будете перенаправлены в Telegram для отправки заявки.');
      closeAgentPopup();
      document.getElementById('agent-form').reset();
    });

    // Закрытие попапов при клике вне формы
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.apply-button') && !e.target.closest('.feedback-popup') && !e.target.closest('.agent-button')) {
        closeFeedbackPopup();
      }
      if (!e.target.closest('.apply-button') && !e.target.closest('.add-psp-popup') && !e.target.closest('.agent-button')) {
        closeAddPspPopup();
      }
      if (!e.target.closest('.apply-button') && !e.target.closest('.invest-popup') && !e.target.closest('.agent-button')) {
        closeInvestPopup();
      }
      if (!e.target.closest('.agent-button') && !e.target.closest('.agent-popup') && !e.target.closest('.apply-button')) {
        closeAgentPopup();
      }
    });
  </script>
</body>
</html>
