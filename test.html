<!DOCTYPE html>
<html>
<head>
  <title>PaysHub</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Inter', sans-serif;
      background-color: #1a1a1a;
      color: #ffffff;
      overflow: hidden;
    }
    .content-container {
      width: 100%;
      height: calc(100% - 50px);
      position: relative;
      overflow-y: auto;
      z-index: 1;
      padding: 60px 15px 70px 15px;
      box-sizing: border-box;
      -webkit-mask-image: linear-gradient(to bottom, black 90%, transparent 100%);
      mask-image: linear-gradient(to bottom, black 90%, transparent 100%);
      transition: filter 0.3s ease;
    }
    .content-container.blurred {
      filter: blur(5px) brightness(0.5);
    }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .tabs {
      display: flex;
      position: fixed;
      bottom: 20px;
      width: 100%;
      background: #1a1a1a;
      padding: 10px;
      box-sizing: border-box;
      z-index: 10;
      transition: filter 0.3s ease;
    }
    .tabs.blurred { filter: blur(5px) brightness(0.5); }
    .tab {
      flex: 1;
      padding: 10px;
      text-align: center;
      cursor: pointer;
      background: #333;
      color: #fff;
      border-radius: 8px;
      margin: 0 5px;
      font-size: 14px;
      transition: background 0.3s;
    }
    .tab.active { background: #007bff; }
    .preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #1a1a1a;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 100;
      transition: opacity 0.3s ease;
      opacity: 1;
    }
    .preloader.hidden {
      opacity: 0;
      pointer-events: none;
    }
    .wallet-container {
      position: relative;
      width: 150px;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1;
      padding-top: 90px;
    }
    .wallet {
      width: 150px;
      height: 105px;
      background: #d2b48c;
      border-radius: 15px 15px 0 0;
      position: relative;
      overflow: hidden;
      box-shadow: 0 3px 7px rgba(0, 0, 0, 0.2);
      z-index: 2;
    }
    .wallet::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 30px;
      background: #b89778;
      border-radius: 15px 15px 0 0;
    }
    .wallet::after {
      content: '';
      position: absolute;
      top: 15px;
      left: 50%;
      transform: translateX(-50%);
      width: 15px;
      height: 15px;
      background: #000000;
      border-radius: 50%;
      box-shadow: 0 1.5px 3px rgba(0, 0, 0, 0.3);
    }
    .coin {
      position: absolute;
      animation: fall 2s infinite linear;
      box-shadow: 0 3px 4px rgba(0, 0, 0, 0.1);
      width: 30px;
      height: 30px;
      background: #FFD700;
      border-radius: 50%;
      z-index: 1;
    }
    @keyframes fall {
      0% { opacity: 1; transform: rotate(0deg); top: -30px; }
      60% { opacity: 1; }
      100% { opacity: 0; top: calc(50% + 30px); transform: rotate(360deg); }
    }
    .welcome-text {
      margin-top: 20px;
      font-size: 20px;
      font-weight: 300;
      text-align: center;
      background: linear-gradient(90deg, #007bff, #00c4b4, #007bff);
      background-size: 200% 100%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: gradientShift 3s infinite linear;
    }
    .welcome-text span { font-size: 28px; font-weight: 500; }
    .header-section {
      background: linear-gradient(135deg, #1a2a44, #1a3c34);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      margin: 0 0 30px 0;
    }
    .header-section h1 {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 10px;
      background: linear-gradient(90deg, #007bff, #00c4b4, #007bff);
      background-size: 200% 100%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: gradientShift 3s infinite linear;
    }
    .header-section .subtitle {
      font-size: 20px;
      color: #ddd;
      margin-bottom: 20px;
    }
    .header-section .stats {
      display: flex;
      justify-content: space-around;
      margin-bottom: 20px;
    }
    .header-section .stat {
      text-align: center;
    }
    .header-section .stat h3 {
      font-size: 14px;
      font-weight: 500;
      color: #aaa;
      margin-bottom: 5px;
    }
    .header-section .stat p {
      font-size: 24px;
      font-weight: 600;
      color: #fff;
      margin: 0;
    }
    .slider-container {
      position: relative;
      width: 100%;
      margin: 30px 0;
      overflow: hidden;
    }
    .slider {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding-bottom: 10px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: none;
      scrollbar-width: none;
      padding-left: 15px;
      padding-right: 15px;
    }
    .slider::-webkit-scrollbar { display: none; }
    .slide {
      flex: 0 0 calc(100% - 30px);
      height: 200px;
      background: #333;
      border-radius: 12px;
      padding: 15px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      scroll-snap-align: start;
    }
    .slide .content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      text-align: left;
      margin-right: 15px;
    }
    .slide h3 {
      font-size: 18px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 10px;
    }
    .slide p {
      font-size: 14px;
      color: #ddd;
      margin-bottom: 15px;
    }
    .slide .apply-button {
      padding: 10px;
      background: #007bff;
      border: none;
      border-radius: 8px;
      color: #fff;
      font-weight: 500;
      cursor: pointer;
      text-align: center;
      width: 100%;
      max-width: 200px;
      transition: background 0.3s;
    }
    .slide .apply-button:hover { background: #0056b3; }
    .slide .image {
      flex: 0 0 120px;
      height: 120px;
      background-size: cover;
      background-position: center;
      border-radius: 50%;
    }
    .slider-dots {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 10px;
      margin-bottom: 15px;
      padding-right: 30px;
    }
    .dot {
      width: 8px;
      height: 8px;
      background: #555;
      border-radius: 50%;
      cursor: pointer;
    }
    .dot.active { background: #007bff; }
    .slider::after { content: ''; flex: 0 0 15px; }
    .partners-section { margin: 30px 0; }
    .partners-section .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 15px;
      position: relative;
      display: inline-block;
    }
    .partners-section .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, #007bff, #00c4b4);
    }
    .partners-grid {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding-bottom: 10px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .partners-grid::-webkit-scrollbar { display: none; }
    .partner-block {
      flex: 0 0 250px;
      background: linear-gradient(135deg, #1a2a44, #1a3c34);
      border-radius: 12px;
      padding: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      scroll-snap-align: start;
    }
    .partner-block.low-risk { background: linear-gradient(135deg, #1a3c34, #2a5c44); }
    .partner-block.medium-risk { background: linear-gradient(135deg, #1a2a44, #2a5c44); }
    .partner-block.high-risk { background: linear-gradient(135deg, #1a2a44, #1a3c34); }
    .partner-block .emoji { font-size: 24px; }
    .partner-block p { font-size: 14px; color: #fff; margin: 0; }
    .latest-rates, .latest-tech { margin: 30px 0; }
    .latest-rates .header-row, .latest-tech .header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }
    .latest-rates .section-title, .latest-tech .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #fff;
      position: relative;
      display: inline-block;
      cursor: pointer;
    }
    .latest-rates .section-title::after, .latest-tech .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, #007bff, #00c4b4);
      transition: width 0.3s ease;
    }
    .latest-rates .section-title:hover::after, .latest-tech .section-title:hover::after { width: 50%; }
    .latest-rates .see-all-button, .latest-tech .see-all-button {
      padding: 8px 15px;
      border: 1px solid #fff;
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      transition: background 0.3s, color 0.3s;
    }
    .latest-rates .see-all-button:hover, .latest-tech .see-all-button:hover {
      background: linear-gradient(90deg, #007bff, #00c4b4);
      color: #fff;
      border-color: transparent;
    }
    .latest-rates .section-subtitle, .latest-tech .section-subtitle {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 15px;
    }
    .rates-cards-container, .tech-cards-container {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding-bottom: 10px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .rates-cards-container::-webkit-scrollbar, .tech-cards-container::-webkit-scrollbar { display: none; }
    .rate-card {
      flex: 0 0 250px;
      background: #2a2a2a;
      border-radius: 12px;
      scroll-snap-align: start;
      transition: transform 0.3s ease;
      border: 3px solid transparent;
    }
    .rate-card:hover { transform: scale(1.02); }
    .rate-card .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 16px;
      padding: 10px 15px;
    }
    .rate-card .card-tags {
      margin-top: 5px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      padding: 0 15px;
      margin-bottom: 10px;
    }
    .rate-card .tag {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      color: #fff;
      background: #333;
    }
    .rate-card .tag.service {
      background: linear-gradient(90deg, #007bff, #00c4b4, #007bff);
      background-size: 200% 100%;
      animation: gradientShift 3s infinite linear;
    }
    .card {
      background: #2a2a2a;
      border-radius: 12px;
      margin-bottom: 15px;
      cursor: pointer;
      transition: transform 0.3s ease;
      position: relative;
      border: 3px solid transparent;
      width: 100%;
      max-width: 400px;
      box-sizing: border-box;
    }
    .card:hover { transform: translateY(-3px); }
    .card.active {
      border: 3px solid transparent;
      background: linear-gradient(#2a2a2a, #2a2a2a) padding-box,
                  linear-gradient(90deg, #007bff, #00c4b4, #007bff) border-box;
      background-size: 200% 100%;
      animation: gradientShift 3s infinite linear;
    }
    .card .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 16px;
      padding: 10px 15px;
    }
    .card .card-tags {
      margin-top: 5px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      padding: 0 15px;
      margin-bottom: 10px;
    }
    .card .tag {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      color: #fff;
      background: #333;
    }
    .card .tag.service {
      background: linear-gradient(90deg, #007bff, #00c4b4, #007bff);
      background-size: 200% 100%;
      animation: gradientShift 3s infinite linear;
    }
    .tech-card {
      background: #2a2a2a;
      border-radius: 12px;
      margin-bottom: 15px;
      cursor: pointer;
      transition: transform 0.3s ease;
      position: relative;
      border: 3px solid transparent;
      width: 100%;
      max-width: 400px;
      box-sizing: border-box;
    }
    .tech-card:hover { transform: translateY(-3px); }
    .tech-card.active {
      border: 3px solid transparent;
      background: linear-gradient(#2a2a2a, #2a2a2a) padding-box,
                  linear-gradient(90deg, #007bff, #00c4b4, #007bff) border-box;
      background-size: 200% 100%;
      animation: gradientShift 3s infinite linear;
    }
    .tech-card .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 16px;
      padding: 10px 15px;
    }
    .tech-card .card-tags {
      margin-top: 5px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      padding: 0 15px;
      margin-bottom: 10px;
    }
    .tech-card .tag {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      color: #fff;
      background: #333;
    }
    .tech-card .tag.tech-type {
      background: linear-gradient(90deg, #007bff, #00c4b4, #007bff);
      background-size: 200% 100%;
      animation: gradientShift 3s infinite linear;
    }
    .tech-card img {
      width: 100%;
      height: 276px;
      border-radius: 12px 12px 0 0;
      display: block;
    }
    .tech-card .short-description {
      padding: 0 15px 15px 15px;
      font-size: 14px;
      color: #ccc;
      display: -webkit-box;
      -webkit-line-clamp: 4;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .ai-assistant, .for-agents {
      background: #2a2a2a;
      border-radius: 12px;
      padding: 20px;
      margin: 30px 0;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    .ai-assistant .section-title, .for-agents .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 5px;
      position: relative;
      display: inline-block;
    }
    .ai-assistant .section-title::after, .for-agents .section-title::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, #007bff, #00c4b4);
    }
    .ai-assistant .section-subtitle, .for-agents .section-subtitle {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 15px;
    }
    .ai-assistant .description, .for-agents .description {
      font-size: 14px;
      color: #ddd;
      margin-bottom: 15px;
      line-height: 1.5;
    }
    .ai-assistant .try-button, .for-agents .agent-button {
      padding: 8px 15px;
      border: 1px solid #fff;
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      transition: background 0.3s, color 0.3s;
      background: transparent;
      cursor: pointer;
    }
    .ai-assistant .try-button:hover, .for-agents .agent-button:hover {
      background: linear-gradient(90deg, #007bff, #00c4b4);
      color: #fff;
      border-color: transparent;
    }
    .info-section {
      background: #2a2a2a;
      border-radius: 12px;
      padding: 20px;
      margin: 30px 0;
    }
    .info-section h3 {
      font-size: 18px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 15px;
    }
    .resources {
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }
    .resource-button {
      flex: 1;
      background: linear-gradient(90deg, #007bff, #00c4b4);
      border-radius: 8px;
      padding: 15px;
      text-align: center;
      text-decoration: none;
      color: #fff;
      font-size: 14px;
      font-weight: 500;
      transition: transform 0.3s ease;
    }
    .resource-button:hover { transform: scale(1.02); }
    .filter-section {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #1a1a1a;
      padding: 10px 15px;
      display: flex;
      gap: 8px;
      flex-wrap: nowrap;
      align-items: center;
      z-index: 10;
      box-sizing: border-box;
    }
    .filter-section h3 {
      font-size: 12px;
      font-weight: 500;
      color: #aaa;
      margin-bottom: 6px;
    }
    .filter-dropdown {
      position: relative;
      flex: 1;
      min-width: 90px;
    }
    .filter-button {
      padding: 4px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      color: #fff;
      background: #333;
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      box-sizing: border-box;
    }
    .filter-button.active {
      background: linear-gradient(90deg, #007bff, #00c4b4, #007bff);
      background-size: 200% 100%;
      animation: gradientShift 3s infinite linear;
    }
    .filter-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.95);
      width: 80%;
      max-height: 70vh;
      background: #2a2a2a;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
      display: none;
      z-index: 30;
      overflow-y: auto;
      opacity: 0;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    .filter-popup.active {
      display: block;
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
    .filter-popup h4 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
      color: #fff;
    }
    .filter-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 15px;
    }
    .filter-tag {
      padding: 6px 12px;
      border-radius: 12px;
      background: #333;
      color: #fff;
      font-size: 13px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .filter-tag.selected { background: #007bff; }
    .popup-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    .popup-button {
      flex: 1;
      padding: 8px;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      font-size: 14px;
      color: #fff;
    }
    .popup-button.apply { background: #007bff; }
    .popup-button.cancel { background: #555; }
    .popup-button.submit { background: #007bff; }
    .card-details {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease;
      margin-top: 10px;
      font-size: 14px;
      color: #ddd;
      position: relative;
      display: flex;
      flex-direction: column;
      padding: 0 15px;
    }
    .card-details.active {
      max-height: none;
      overflow: visible;
      padding: 10px 15px 0 15px;
    }
    .details-block { margin-bottom: 15px; }
    .details-block h4 {
      font-size: 14px;
      font-weight: 600;
      color: #aaa;
      margin-bottom: 8px;
    }
    .info-tag {
      display: inline-block;
      padding: 6px 10px;
      margin: 4px 4px 0 0;
      border-radius: 12px;
      font-size: 13px;
      color: #fff;
      background: #333;
      transition: opacity 0.3s ease;
      opacity: 0;
      line-height: 1.5;
      white-space: pre-wrap;
    }
    .card-details.active .info-tag {
      opacity: 1;
      animation: fadeIn 0.3s ease forwards;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .apply-button {
      margin-top: 15px;
      padding: 10px;
      background: #007bff;
      border: none;
      border-radius: 8px;
      color: #fff;
      font-weight: 500;
      cursor: pointer;
      text-align: center;
      display: block;
      width: 100%;
      transition: background 0.3s;
    }
    .apply-button:hover { background: #0056b3; }
    .apply-button-container {
      padding: 10px 0;
      border-top: 1px solid #333;
    }
    .feedback-popup, .add-psp-popup, .invest-popup, .agent-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.95);
      width: 80%;
      max-height: 70vh;
      background: #2a2a2a;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
      display: none;
      z-index: 30;
      overflow-y: auto;
      opacity: 0;
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    .feedback-popup.active, .add-psp-popup.active, .invest-popup.active, .agent-popup.active {
      display: block;
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
    .feedback-instruction, .add-psp-instruction, .invest-instruction, .agent-instruction {
      font-size: 13px;
      color: #ddd;
      background: #333;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 15px;
      line-height: 1.5;
    }
    .feedback-form, .add-psp-form, .invest-form, .agent-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .feedback-form input, .add-psp-form input, .invest-form input, .agent-form input,
    .feedback-form textarea, .add-psp-form textarea, .invest-form textarea, .agent-form textarea {
      padding: 8px;
      border: 1px solid #555;
      border-radius: 8px;
      background: #333;
      color: #fff;
      font-size: 14px;
      outline: none;
      resize: none;
    }
    .feedback-form textarea, .add-psp-form textarea, .invest-form textarea, .agent-form textarea { height: 100px; }
    .notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #2a2a2a;
      border-radius: 8px;
      padding: 15px;
      color: #fff;
      font-size: 14px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
      z-index: 40;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none; /* Отключаем клики, когда невидимо */
    }
    .notification.active {
      opacity: 1;
      pointer-events: auto; /* Включаем клики, когда видно */
    }
    .privacy-notice {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #2a2a2a;
      border-radius: 8px;
      padding: 15px;
      color: #fff;
      font-size: 14px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
      z-index: 40;
      opacity: 0;
      transition: opacity 0.3s ease;
      max-width: 90%;
      text-align: center;
      pointer-events: none;
    }
    .privacy-notice.active {
      opacity: 1;
      pointer-events: auto;
    }
    .privacy-content p { margin: 0; }
    .privacy-content a { color: #007bff; text-decoration: underline; }
    @keyframes gradientShift {
      0% { background-position: 0% 0%; }
      100% { background-position: 200% 0%; }
    }
    @media (max-width: 600px) {
      .content-container { height: calc(100vh - 50px); padding: 50px 10px 60px 10px; }
      .tabs { bottom: 10px; padding: 5px; }
      .tab { font-size: 12px; margin: 0 3px; }
      .header-section h1 { font-size: 24px; }
      .header-section .subtitle { font-size: 18px; }
      .header-section .stat h3 { font-size: 12px; }
      .header-section .stat p { font-size: 20px; }
      .slide h3 { font-size: 16px; }
      .slide p { font-size: 13px; }
      .slide .apply-button { max-width: none; }
      .slide .image { flex: 0 0 100px; height: 100px; }
      .partner-block { flex: 0 0 200px; }
      .partner-block p { font-size: 13px; }
      .rate-card, .tech-card { flex: 0 0 200px; }
      .rate-card .card-header, .tech-card .card-header { font-size: 14px; }
      .tech-card img { height: 120px; }
      .ai-assistant .section-title, .for-agents .section-title { font-size: 18px; }
      .ai-assistant .section-subtitle, .for-agents .section-subtitle { font-size: 13px; }
      .ai-assistant .description, .for-agents .description { font-size: 13px; }
      .info-section h3 { font-size: 16px; }
      .resources { flex-direction: column; }
      .resource-button { font-size: 13px; }
      .filter-section { flex-wrap: wrap; gap: 6px; padding: 8px 10px; }
      .filter-dropdown { min-width: 80px; }
      .filter-button { padding: 3px 8px; font-size: 11px; }
      .filter-section h3 { font-size: 11px; margin-bottom: 4px; }
      .filter-popup, .feedback-popup, .add-psp-popup, .invest-popup, .agent-popup { width: 90%; }
      .card, .tech-card { width: 100%; max-width: 100%; }
      .card-header { font-size: 14px; padding: 10px; }
      .card-details { font-size: 12px; }
      .tech-card img { height: auto; max-height: 276px; }
    }
  </style>
</head>
<body>
  <div class="preloader" id="preloader">
    <div class="wallet-container">
      <div class="wallet"></div>
      <div class="coin" style="left: 30px; animation-delay: 0s;"></div>
      <div class="coin" style="left: 60px; animation-delay: 0.2s;"></div>
      <div class="coin" style="left: 90px; animation-delay: 0.4s;"></div>
      <div class="coin" style="left: 45px; animation-delay: 0.6s;"></div>
      <div class="coin" style="left: 75px; animation-delay: 0.8s;"></div>
      <div class="coin" style="left: 37.5px; animation-delay: 1s;"></div>
      <div class="coin" style="left: 82.5px; animation-delay: 1.2s;"></div>
      <div class="coin" style="left: 52.5px; animation-delay: 1.4s;"></div>
      <div class="coin" style="left: 67.5px; animation-delay: 1.6s;"></div>
      <div class="coin" style="left: 97.5px; animation-delay: 1.8s;"></div>
      <div class="welcome-text">Welcome to <span>PaysHub</span></div>
    </div>
  </div>
  <div class="content-container">
    <div id="home" class="tab-content active">
      <div class="header-section">
        <h1>PaysHub</h1>
        <div class="subtitle">Агрегатор платежных решений</div>
        <div class="stats">
          <div class="stat"><h3>PSP</h3><p>20+</p></div>
          <div class="stat"><h3>Решений</h3><p>50+</p></div>
          <div class="stat"><h3>Партнеров</h3><p>1000+</p></div>
        </div>
      </div>
      <div class="slider-container">
        <div class="slider" id="intro-slider">
          <div class="slide">
            <div class="content">
              <h3>Для клиентов</h3>
              <p>Подбираем оптимальные платёжные системы для бизнеса любого уровня (low & high).</p>
              <button class="apply-button" onclick="openFeedbackPopup()">Оставить запрос</button>
            </div>
            <div class="image" style="background-image: url('https://github.com/PaysHub/List/raw/main/images/s1.png');"></div>
          </div>
          <div class="slide">
            <div class="content">
              <h3>Для платёжек и банков</h3>
              <p>Объединяем PSP, банки и финтех в B2B-коллаборации. Продажа и аренда готовых технических решений и White Label.</p>
              <button class="apply-button" onclick="openAddPspPopup()">Добавить PSP</button>
            </div>
            <div class="image" style="background-image: url('https://github.com/PaysHub/List/raw/main/images/s2.png');"></div>
          </div>
          <div class="slide">
            <div class="content">
              <h3>Инвестиции</h3>
              <p>Привлекаем капитал для масштабирования платёжных систем – лицензии, новые регионы, ликвидность – за долю в компании.</p>
              <button class="apply-button" onclick="openInvestPopup()">Подробнее</button>
            </div>
            <div class="image" style="background-image: url('https://github.com/PaysHub/List/raw/main/images/s3.png');"></div>
          </div>
        </div>
        <div class="slider-dots" id="slider-dots"></div>
      </div>
      <div class="partners-section">
        <div class="section-title">Кто наши клиенты</div>
        <div class="partners-grid">
          <div class="partner-block"><span class="emoji">🏬</span><p>Работаем с традиционными бизнесами: e-commerce, ритейл, услуги.</p></div>
          <div class="partner-block low-risk"><span class="emoji">🛡️</span><p>Поддерживаем бизнесы с низким риском: SaaS, образование, благотворительность.</p></div>
          <div class="partner-block medium-risk"><span class="emoji">📈</span><p>Решения для бизнесов среднего риска: финтех, туризм, подписки.</p></div>
          <div class="partner-block high-risk"><span class="emoji">⚡</span><p>Работаем с высокорисковыми бизнесами: гемблинг, крипта, дейтинг.</p></div>
        </div>
      </div>
      <div class="latest-rates">
        <div class="header-row">
          <div class="section-title">Ставки</div>
          <a href="#" class="see-all-button" onclick="showTab('rates')">Все</a>
        </div>
        <div class="section-subtitle">Самые актуальные предложения по ставкам</div>
        <div class="rates-cards-container" id="home-rates-content"><p>Загрузка...</p></div>
      </div>
      <div class="latest-tech">
        <div class="header-row">
          <div class="section-title">Решения</div>
          <a href="#" class="see-all-button" onclick="showTab('tech')">Все</a>
        </div>
        <div class="section-subtitle">Инновационные технологии для вашего бизнеса</div>
        <div class="tech-cards-container" id="home-tech-content"><p>Загрузка...</p></div>
      </div>
      <div class="ai-assistant">
        <div class="section-title">ИИ-ассистент для вашего бизнеса</div>
        <div class="section-subtitle">Автоматизируйте подбор решений с помощью ИИ</div>
        <div class="description">Наш ИИ-ассистент анализирует ваши потребности и подбирает оптимальные платёжные решения за секунды.</div>
        <a href="#" class="try-button">Попробовать ИИ-ассистента →</a>
      </div>
      <div class="for-agents">
        <div class="section-title">Для агентов</div>
        <div class="section-subtitle">Зарабатывайте с нами</div>
        <div class="description">Присоединяйтесь к нашей партнёрской программе и получайте доход за привлечение клиентов.</div>
        <button class="agent-button" onclick="openAgentPopup()">Стать агентом →</button>
      </div>
      <div class="info-section">
        <h3>Ресурсы:</h3>
        <div class="resources">
          <a href="https://t.me/pays_hub" target="_blank" class="resource-button">Канал @pays_hub</a>
          <a href="https://t.me/p_fintech" target="_blank" class="resource-button">Оператор @p_fintech</a>
        </div>
      </div>
    </div>
    <div id="rates" class="tab-content">
      <div class="filter-section">
        <div class="filter-dropdown"><h3>Индустрия</h3><div class="filter-button" id="industry-button">Все</div></div>
        <div class="filter-dropdown"><h3>Гео</h3><div class="filter-button" id="geo-button">Все</div></div>
        <div class="filter-dropdown"><h3>Риск</h3><div class="filter-button" id="risk-button">Все</div></div>
      </div>
      <div id="rates-content"></div>
    </div>
    <div id="tech" class="tab-content">
      <div class="filter-section">
        <div class="filter-dropdown"><h3>Тип</h3><div class="filter-button" id="type-button">Все</div></div>
      </div>
      <div id="tech-content"><p>Загрузка...</p></div>
    </div>
  </div>
  <div class="tabs">
    <div class="tab active" onclick="showTab('home')">Главная</div>
    <div class="tab" onclick="showTab('rates')">Ставки</div>
    <div class="tab" onclick="showTab('tech')">Решения</div>
    <div class="tab" onclick="openTelegram()">Оператор</div>
  </div>

  <div class="filter-popup" id="industry-popup">
    <h4>Выберите индустрии</h4>
    <div class="filter-tags" id="industry-options"></div>
    <div class="popup-actions">
      <div class="popup-button apply" onclick="applyFilter('industry')">Применить</div>
      <div class="popup-button cancel" onclick="closePopup('industry-popup')">Закрыть</div>
    </div>
  </div>
  <div class="filter-popup" id="geo-popup">
    <h4>Выберите регионы</h4>
    <div class="filter-tags" id="geo-options"></div>
    <div class="popup-actions">
      <div class="popup-button apply" onclick="applyFilter('geo')">Применить</div>
      <div class="popup-button cancel" onclick="closePopup('geo-popup')">Закрыть</div>
    </div>
  </div>
  <div class="filter-popup" id="risk-popup">
    <h4>Выберите уровни риска</h4>
    <div class="filter-tags" id="risk-options"></div>
    <div class="popup-actions">
      <div class="popup-button apply" onclick="applyFilter('risk')">Применить</div>
      <div class="popup-button cancel" onclick="closePopup('risk-popup')">Закрыть</div>
    </div>
  </div>
  <div class="filter-popup" id="type-popup">
    <h4>Выберите тип</h4>
    <div class="filter-tags" id="type-options"></div>
    <div class="popup-actions">
      <div class="popup-button apply" onclick="applyFilter('type')">Применить</div>
      <div class="popup-button cancel" onclick="closePopup('type-popup')">Закрыть</div>
    </div>
  </div>
  <div class="feedback-popup" id="feedback-popup">
    <h4>Запрос на подбор PSP</h4>
    <div class="feedback-instruction">
      Оставьте заявку, и мы подберем платежное решение. Укажите:<br>- Объем платежей в месяц<br>- Адрес сайта<br>- Методы платежей (карты, P2P, крипта и т.д.)<br>- Есть ли юрлицо (где зарегистрировано)
    </div>
    <form class="feedback-form" id="feedback-form">
      <input type="text" id="feedback-telegram" placeholder="Ваш Telegram-ник или телефон" required>
      <textarea id="feedback-message" placeholder="Ответы на вопросы" required></textarea>
      <div class="popup-actions">
        <button type="submit" class="popup-button submit">Отправить</button>
        <button type="button" class="popup-button cancel" onclick="closeFeedbackPopup()">Закрыть</button>
      </div>
    </form>
  </div>
  <div class="add-psp-popup" id="add-psp-popup">
    <h4>Добавление PSP в список</h4>
    <div class="add-psp-instruction">
      Оставьте заявку, чтобы добавить вашу платежную систему в список. Укажите:<br>- Название PSP<br>- Сайт<br>- Контакт для связи (Telegram)<br>- Тип платежей (Low-risk, High-risk, Криптовалюта, Карты и т.д.)<br>- Доступные страны<br>- Валюта расчетов<br>- Комиссия (фиксированная или %)<br>- API-документация (если есть)
    </div>
    <form class="add-psp-form" id="add-psp-form">
      <input type="text" id="add-psp-telegram" placeholder="Ваш Telegram-ник или телефон" required>
      <textarea id="add-psp-message" placeholder="Ответы на вопросы" required></textarea>
      <div class="popup-actions">
        <button type="submit" class="popup-button submit">Отправить</button>
        <button type="button" class="popup-button cancel" onclick="closeAddPspPopup()">Закрыть</button>
      </div>
    </form>
  </div>
  <div class="invest-popup" id="invest-popup">
    <h4>Инвестиции</h4>
    <div class="invest-instruction">
      Мы ищем проекты для инвестиций. Нам интересны:<br>- Платёжные системы с лицензиями<br>- Проекты в финтехе, крипте, гемблинге<br>- Бизнесы с оборотом от $1M в месяц<br>- Команды с опытом в индустрии<br>Требования:<br>- Наличие юрлица<br>- Прозрачная финансовая отчётность<br>- Готовность к масштабированию<br>Оставьте заявку, указав информацию о вашем проекте.
    </div>
    <form class="invest-form" id="invest-form">
      <input type="text" id="invest-telegram" placeholder="Ваш Telegram-ник или телефон" required>
      <textarea id="invest-message" placeholder="Ответы на вопросы" required></textarea>
      <div class="popup-actions">
        <button type="submit" class="popup-button submit">Отправить</button>
        <button type="button" class="popup-button cancel" onclick="closeInvestPopup()">Закрыть</button>
      </div>
    </form>
  </div>
  <div class="agent-popup" id="agent-popup">
    <h4>Стать агентом</h4>
    <div class="agent-instruction">
      Оставьте заявку, чтобы стать агентом и зарабатывать с нами. Укажите:<br>- Ваш опыт в привлечении клиентов<br>- Какие проекты или компании вы представляете<br>- Ожидания от сотрудничества
    </div>
    <form class="agent-form" id="agent-form">
      <input type="text" id="agent-telegram" placeholder="Ваш Telegram-ник или телефон" required>
      <textarea id="agent-message" placeholder="Ответы на вопросы" required></textarea>
      <div class="popup-actions">
        <button type="submit" class="popup-button submit">Отправить</button>
        <button type="button" class="popup-button cancel" onclick="closeAgentPopup()">Закрыть</button>
      </div>
    </form>
  </div>
  <div class="notification" id="notification">Сообщение успешно отправлено!</div>
  <div class="privacy-notice" id="privacy-notice">
    <div class="privacy-content">
      <p>Продолжая использовать приложение, вы соглашаетесь с нашей <a href="https://example.com/privacy-policy" target="_blank">политикой конфиденциальности</a>.</p>
    </div>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    const API_TOKEN = 'ubicp2nFx8L47YOV3MOyn1FhUIPQ4EMESzFnrL3L';
    const BASE_URL = 'https://app.nocodb.com/api/v2/tables/';
    const RATES_TABLE_ID = 'mbz9kdbkba6i9t2';
    const TECH_TABLE_ID = 'mnliw8pc7zmrw35';

    let ratesData = [];
    let techData = [];
    let activeFilters = { industry: new Set(), geo: new Set(), risk: new Set(), type: new Set() };
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const dotsContainer = document.getElementById('slider-dots');
    const slider = document.getElementById('intro-slider');
    const telegramUser = tg.initDataUnsafe.user;
    const telegramUsername = telegramUser ? telegramUser.username : '';
    const telegramId = telegramUser ? telegramUser.id : 'Неизвестно';
    const telegramFirstName = telegramUser ? telegramUser.first_name : 'Неизвестно';
    const telegramLastName = telegramUser ? telegramUser.last_name : 'Неизвестно';

    slides.forEach((_, index) => {
      const dot = document.createElement('div');
      dot.className = 'dot';
      dot.addEventListener('click', () => { currentSlide = index; updateSlider(); });
      dotsContainer.appendChild(dot);
    });
    const dots = document.querySelectorAll('.dot');
    dots[0].classList.add('active');

    function updateSliderDots() {
      const slideWidth = slides[0].offsetWidth + 15;
      const scrollPosition = slider.scrollLeft;
      const newSlideIndex = Math.round(scrollPosition / slideWidth);
      currentSlide = Math.max(0, Math.min(slides.length - 1, newSlideIndex));
      dots.forEach((dot, index) => dot.classList.toggle('active', index === currentSlide));
    }
    slider.addEventListener('scroll', updateSliderDots);

    function showNotification(message) {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.classList.add('active');
      setTimeout(() => notification.classList.remove('active'), 3000);
    }

    function showPrivacyNotice() {
      if (!localStorage.getItem('privacyNoticeShown')) {
        const notice = document.getElementById('privacy-notice');
        notice.classList.add('active');
        setTimeout(() => {
          notice.classList.remove('active');
          localStorage.setItem('privacyNoticeShown', 'true');
        }, 5000);
      }
    }

    function openFeedbackPopup() {
      const popup = document.getElementById('feedback-popup');
      document.getElementById('feedback-telegram').value = telegramUsername ? `@${telegramUsername}` : '';
      popup.classList.add('active');
      document.querySelector('.content-container').classList.add('blurred');
      document.querySelector('.tabs').classList.add('blurred');
    }
    function closeFeedbackPopup() {
      document.getElementById('feedback-popup').classList.remove('active');
      document.querySelector('.content-container').classList.remove('blurred');
      document.querySelector('.tabs').classList.remove('blurred');
    }
    function openAddPspPopup() {
      const popup = document.getElementById('add-psp-popup');
      document.getElementById('add-psp-telegram').value = telegramUsername ? `@${telegramUsername}` : '';
      popup.classList.add('active');
      document.querySelector('.content-container').classList.add('blurred');
      document.querySelector('.tabs').classList.add('blurred');
    }
    function closeAddPspPopup() {
      document.getElementById('add-psp-popup').classList.remove('active');
      document.querySelector('.content-container').classList.remove('blurred');
      document.querySelector('.tabs').classList.remove('blurred');
    }
    function openInvestPopup() {
      const popup = document.getElementById('invest-popup');
      document.getElementById('invest-telegram').value = telegramUsername ? `@${telegramUsername}` : '';
      popup.classList.add('active');
      document.querySelector('.content-container').classList.add('blurred');
      document.querySelector('.tabs').classList.add('blurred');
    }
    function closeInvestPopup() {
      document.getElementById('invest-popup').classList.remove('active');
      document.querySelector('.content-container').classList.remove('blurred');
      document.querySelector('.tabs').classList.remove('blurred');
    }
    function openAgentPopup() {
      const popup = document.getElementById('agent-popup');
      document.getElementById('agent-telegram').value = telegramUsername ? `@${telegramUsername}` : '';
      popup.classList.add('active');
      document.querySelector('.content-container').classList.add('blurred');
      document.querySelector('.tabs').classList.add('blurred');
    }
    function closeAgentPopup() {
      document.getElementById('agent-popup').classList.remove('active');
      document.querySelector('.content-container').classList.remove('blurred');
      document.querySelector('.tabs').classList.remove('blurred');
    }

    document.querySelectorAll('input, textarea').forEach(input => {
      input.addEventListener('focus', () => document.querySelector('.content-container').classList.add('blurred'));
      input.addEventListener('blur', () => {
        if (!document.querySelector('.feedback-popup.active') && !document.querySelector('.add-psp-popup.active') &&
            !document.querySelector('.invest-popup.active') && !document.querySelector('.agent-popup.active')) {
          document.querySelector('.content-container').classList.remove('blurred');
          document.querySelector('.tabs').classList.remove('blurred');
        }
      });
    });

    async function fetchData(tableId) {
      try {
        const response = await fetch(`${BASE_URL}${tableId}/records?offset=0&limit=100`, {
          headers: { 'xc-token': API_TOKEN }
        });
        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
        const data = await response.json();
        return data.list || [];
      } catch (error) {
        console.error(`Ошибка при получении данных для tableId ${tableId}:`, error);
        return [];
      }
    }

    async function extractImageUrl(imgField) {
      if (!imgField) return 'https://placehold.co/400x276';
      if (typeof imgField === 'string') {
        if (imgField.startsWith('http://') || imgField.startsWith('https://')) return imgField;
        const match = imgField.match(/\((https:\/\/[^\)]+)\)/);
        if (match) return `${match[1]}?xc-token=${API_TOKEN}`;
      }
      if (Array.isArray(imgField) && imgField.length > 0) {
        const imageUrl = imgField[0].url;
        if (imageUrl) return `${imageUrl}?xc-token=${API_TOKEN}`;
      }
      return 'https://placehold.co/400x276';
    }

    function getTags(row, field) {
      return row[field] ? row[field].split(',').map(tag => tag.trim()) : [];
    }

    function isEmptyValue(value) {
      return !value || value === 'N/A' || value.trim() === '';
    }

    function formatText(text) {
      return text ? text.replace(/\n/g, '<br>') : '';
    }

    function truncateText(text, maxLength) {
      if (!text || text.length <= maxLength) return text;
      return text.substring(0, maxLength) + '...';
    }

    function renderFilters(containerId, buttonId, popupId, rows, field, filterType) {
      const container = document.getElementById(containerId);
      const button = document.getElementById(buttonId);
      const popup = document.getElementById(popupId);
      const tags = new Set(['Все']);
      rows.forEach(row => {
        if (filterType === 'type') tags.add(row[field] || 'N/A');
        else getTags(row, field).forEach(tag => tags.add(tag));
      });

      button.addEventListener('click', (e) => {
        e.stopPropagation();
        document.querySelectorAll('.filter-popup').forEach(p => { if (p !== popup) p.classList.remove('active'); });
        popup.classList.toggle('active');
        document.querySelector('.content-container').classList.toggle('blurred');
        document.querySelector('.tabs').classList.toggle('blurred');
      });

      Array.from(tags).sort().forEach(tag => {
        const tagElement = document.createElement('div');
        tagElement.className = 'filter-tag';
        tagElement.textContent = tag;
        tagElement.dataset.value = tag;
        if (activeFilters[filterType].has(tag)) tagElement.classList.add('selected');
        tagElement.addEventListener('click', () => {
          if (tag === 'Все') {
            container.querySelectorAll('.filter-tag').forEach(t => t.classList.remove('selected'));
            tagElement.classList.add('selected');
          } else {
            container.querySelector('.filter-tag[data-value="Все"]').classList.remove('selected');
            tagElement.classList.toggle('selected');
          }
        });
        container.appendChild(tagElement);
      });
    }

    function applyFilter(filterType) {
      const popup = document.getElementById(`${filterType}-popup`);
      const button = document.getElementById(`${filterType}-button`);
      const selectedTags = popup.querySelectorAll('.filter-tag.selected');
      activeFilters[filterType].clear();
      const selectedValues = Array.from(selectedTags).map(tag => tag.dataset.value);

      if (selectedValues.length === 0 || selectedValues.includes('Все')) {
        activeFilters[filterType].clear();
        button.textContent = 'Все';
        button.classList.remove('active');
      } else {
        selectedValues.forEach(tag => activeFilters[filterType].add(tag));
        button.textContent = selectedValues.join(', ');
        button.classList.add('active');
      }

      if (filterType === 'type') renderTech('tech-content', techData);
      else renderRates('rates-content', ratesData);
      closePopup(`${filterType}-popup`);
    }

    function closePopup(popupId) {
      document.getElementById(popupId).classList.remove('active');
      document.querySelector('.content-container').classList.remove('blurred');
      document.querySelector('.tabs').classList.remove('blurred');
    }

    function renderRates(containerId, rows) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';
      let filteredRows = rows.filter(row => row['On'] === true);

      if (containerId === 'rates-content') {
        if (activeFilters.industry.size > 0) {
          filteredRows = filteredRows.filter(row => getTags(row, 'Industry').some(tag => activeFilters.industry.has(tag)));
        }
        if (activeFilters.geo.size > 0) {
          filteredRows = filteredRows.filter(row => getTags(row, 'Geo').some(tag => activeFilters.geo.has(tag)));
        }
        if (activeFilters.risk.size > 0) {
          filteredRows = filteredRows.filter(row => getTags(row, 'Risk').some(tag => activeFilters.risk.has(tag)));
        }
      } else if (containerId === 'home-rates-content') {
        filteredRows = filteredRows.filter(row => row['HB'] === true);
      }

      if (filteredRows.length === 0) {
        container.innerHTML = '<p>Нет данных для отображения</p>';
        return;
      }

      filteredRows.forEach(row => {
        const card = document.createElement('div');
        card.className = containerId === 'home-rates-content' ? 'rate-card' : 'card';

        const tariffsBlock = [
          { label: 'Pay in', value: row['Pay in (%)'] },
          { label: 'Pay out', value: row['Pay out (%)'] },
          { label: 'Method', value: row['Method'] },
          { label: 'Roll reserve', value: row['Roll reserve'] },
          { label: 'Refund fee', value: row['Refound fee'] }
        ].filter(item => !isEmptyValue(item.value)).map(item => `<span class="info-tag">${item.label}: ${item.value}</span>`).join('');

        const transactionsBlock = [
          { label: 'Min trans', value: row['($) Min transaction'] },
          { label: 'Max trans', value: row['($) Max transaction'] },
          { label: 'Min turnover', value: row['($) Мин. оборот'] },
          { label: 'Max turnover', value: row['($) Макс. оборот'] },
          { label: 'Additional fees', value: row['Доп. платежи'] },
          { label: 'Прием в', value: row['Прием в'] },
          { label: 'Расчет в', value: row['Расчет в'] }
        ].filter(item => !isEmptyValue(item.value)).map(item => `<span class="info-tag">${item.label}: ${item.value}</span>`).join('');

        const mainInfoBlock = [
          { label: 'Индустрия', value: row['Industry'] },
          { label: 'Гео', value: row['Geo'] },
          { label: 'Риск', value: row['Risk'] }
        ].filter(item => !isEmptyValue(item.value)).map(item => `<span class="info-tag">${item.label}: ${item.value}</span>`).join('');

        const additionalBlock = [
          { label: 'Type traffic', value: row['Type traffic'] },
          { label: 'Settlement', value: row['Settlement'] },
          { label: 'Settlement amount', value: row['Settlement amount'] },
          { label: 'License', value: row['Лицензия'] },
          { label: 'Integration', value: row['Интеграция'] },
          { label: 'Compliance', value: row['Compliance'] },
          { label: 'Support 24/7', value: row['Support 24/7'] },
          { label: 'Recurrent', value: row['Рекуррент'] },
          { label: 'Chargeback level', value: row['Уровень чарджбэков'] },
          { label: '3DS', value: row['3DS-авторизация'] },
          { label: 'Liquidity', value: row['Ликвидность'] },
          { label: 'Conversion', value: row['Конверсия'] },
          { label: 'Years on market', value: row['На рынке (лет)'] }
        ].filter(item => !isEmptyValue(item.value)).map(item => `<span class="info-tag">${item.label}: ${item.value}</span>`).join('');

        const commentsBlock = !isEmptyValue(row['Комментарии']) ? `<span class="info-tag" style="display: block;">${formatText(row['Комментарии'])}</span>` : '';

        const industryTag = getTags(row, 'Industry')[0] || 'N/A';
        const geoTag = getTags(row, 'Geo')[0] || 'N/A';
        const riskTag = getTags(row, 'Risk')[0] || 'N/A';

        card.innerHTML = `
          <div class="card-header">
            <span>${row['ID Name'] || 'Без названия'}</span>
            <span>${row['Pay in (%)'] || ''}</span>
          </div>
          <div class="card-tags">
            <span class="tag service">${row['Service'] || 'N/A'}</span>
            <span class="tag">${industryTag}</span>
            <span class="tag">${geoTag}</span>
            <span class="tag">${riskTag}</span>
          </div>
          ${containerId === 'rates-content' ? `
          <div class="card-details">
            ${mainInfoBlock ? `<div class="details-block"><h4>Основная информация</h4>${mainInfoBlock}</div>` : ''}
            ${tariffsBlock ? `<div class="details-block"><h4>Тарифы</h4>${tariffsBlock}</div>` : ''}
            ${transactionsBlock ? `<div class="details-block"><h4>Транзакции</h4>${transactionsBlock}</div>` : ''}
            ${additionalBlock ? `<div class="details-block"><h4>Дополнительно</h4>${additionalBlock}</div>` : ''}
            ${commentsBlock ? `<div class="details-block"><h4>Комментарии</h4>${commentsBlock}</div>` : ''}
            <div class="apply-button-container">
              <button class="apply-button" onclick="window.open('https://t.me/p_fintech?text=Im interested in ${row['ID Name']}', '_blank')">Подать заявку</button>
            </div>
          </div>
          ` : ''}
        `;
        if (containerId === 'rates-content') {
          card.addEventListener('click', (e) => {
            if (e.target.classList.contains('apply-button')) return;
            const details = card.querySelector('.card-details');
            details.classList.toggle('active');
            card.classList.toggle('active');
          });
        }
        container.appendChild(card);
      });
    }

    async function renderTech(containerId, rows) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';
      let filteredRows = rows.filter(row => row['On'] === true);

      if (containerId === 'home-tech-content') filteredRows = filteredRows.filter(row => row['HB'] === true);
      if (activeFilters.type.size > 0) {
        filteredRows = filteredRows.filter(row => activeFilters.type.has(row['Type'] || 'N/A'));
      }

      if (filteredRows.length === 0) {
        container.innerHTML = '<p>Нет данных для отображения</p>';
        return;
      }

      for (const row of filteredRows) {
        const imgUrl = await extractImageUrl(row['Img']);
        const card = document.createElement('div');
        card.className = containerId === 'home-tech-content' ? 'tech-card' : 'tech-card';
        const truncatedName = truncateText(row['Name'] || 'Без названия', 20);

        const mainInfoBlock = [
          { label: 'ID', value: row['ID name'] },
          { label: 'Название', value: row['Name'] },
          { label: 'Тип', value: row['Type'] },
          { label: 'Цена', value: row['Price'] },
          { label: 'Условия', value: row['Terms'] }
        ].filter(item => !isEmptyValue(item.value)).map(item => `<span class="info-tag">${item.label}: ${item.value}</span>`).join('');

        const descriptionBlock = !isEmptyValue(row['Description']) ? `<span class="info-tag" style="display: block;">${formatText(row['Description'])}</span>` : '';

        card.innerHTML = `
          <img src="${imgUrl}" alt="Tech Solution" onerror="this.src='https://placehold.co/400x276';">
          <div class="card-header">
            <span>${truncatedName}</span>
            <span>${row['Price'] || ''}</span>
          </div>
          <div class="card-tags">
            <span class="tag tech-type">${row['Type'] || 'White Label'}</span>
          </div>
          ${containerId === 'tech-content' ? `
          <div class="short-description">${row['Short description'] || 'Нет краткого описания'}</div>
          <div class="card-details">
            ${mainInfoBlock ? `<div class="details-block"><h4>Основная информация</h4>${mainInfoBlock}</div>` : ''}
            ${descriptionBlock ? `<div class="details-block"><h4>Описание</h4>${descriptionBlock}</div>` : ''}
            <div class="apply-button-container">
              <button class="apply-button" onclick="window.open('https://t.me/p_fintech?text=Im interested in ${row['ID name']}', '_blank')">Подать заявку</button>
            </div>
          </div>
          ` : ''}
        `;
        if (containerId === 'tech-content') {
          card.addEventListener('click', (e) => {
            if (e.target.classList.contains('apply-button')) return;
            const details = card.querySelector('.card-details');
            details.classList.toggle('active');
            card.classList.toggle('active');
          });
        }
        container.appendChild(card);
      }
    }

    async function loadData() {
      const [rates, tech] = await Promise.all([fetchData(RATES_TABLE_ID), fetchData(TECH_TABLE_ID)]);
      ratesData = rates;
      techData = tech;

           renderFilters('industry-options', 'industry-button', 'industry-popup', ratesData, 'Industry', 'industry');
      renderFilters('geo-options', 'geo-button', 'geo-popup', ratesData, 'Geo', 'geo');
      renderFilters('risk-options', 'risk-button', 'risk-popup', ratesData, 'Risk', 'risk');
      renderFilters('type-options', 'type-button', 'type-popup', techData, 'Type', 'type');

      renderRates('home-rates-content', ratesData);
      renderRates('rates-content', ratesData);
      await renderTech('home-tech-content', techData);
      await renderTech('tech-content', techData);
    }

    function showTab(tabId) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      document.querySelector(`[onclick="showTab('${tabId}')"]`).classList.add('active');
      document.getElementById(tabId).classList.add('active');
      adjustContentPadding();
    }

    function openTelegram() {
      window.open('https://t.me/p_fintech?text=I%20need%20help%20with%20the%20PaysHub%20service', '_blank');
    }

    function adjustContentPadding() {
  const filterSection = document.querySelector('.filter-section');
  const contentContainer = document.querySelector('.content-container');
  if (filterSection && (document.getElementById('rates').classList.contains('active') || document.getElementById('tech').classList.contains('active'))) {
    const filterHeight = filterSection.offsetHeight;
    contentContainer.style.paddingTop = `${filterHeight + 15}px`; // Увеличиваем отступ
  } else {
    contentContainer.style.paddingTop = '60px';
  }
}

    document.getElementById('feedback-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const telegram = document.getElementById('feedback-telegram').value;
      const message = document.getElementById('feedback-message').value;
      const serverUrl = 'https://payshub-feedback-bot.glitch.me/send-message';
      try {
        const response = await fetch(serverUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            telegram,
            message: `Новая заявка на подбор PSP:\n\nTelegram: ${telegram}\nСообщение: ${message}\n\nДанные пользователя:\nID: ${telegramId}\nИмя: ${telegramFirstName}\nФамилия: ${telegramLastName}\nUsername: @${telegramUsername || 'Не указан'}`
          })
        });
        const result = await response.json();
        if (response.ok) {
          showNotification('Заявка успешно отправлена!');
          closeFeedbackPopup();
          document.getElementById('feedback-form').reset();
        } else showNotification(result.error || 'Ошибка при отправке заявки.');
      } catch (error) {
        console.error('Ошибка:', error);
        showNotification('Произошла ошибка.');
      }
    });

    document.getElementById('add-psp-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const telegram = document.getElementById('add-psp-telegram').value;
      const message = document.getElementById('add-psp-message').value;
      const serverUrl = 'https://payshub-feedback-bot.glitch.me/send-message';
      try {
        const response = await fetch(serverUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            telegram,
            message: `Новая заявка на добавление PSP:\n\nTelegram: ${telegram}\nСообщение: ${message}\n\nДанные пользователя:\nID: ${telegramId}\nИмя: ${telegramFirstName}\nФамилия: ${telegramLastName}\nUsername: @${telegramUsername || 'Не указан'}`
          })
        });
        const result = await response.json();
        if (response.ok) {
          showNotification('Заявка успешно отправлена!');
          closeAddPspPopup();
          document.getElementById('add-psp-form').reset();
        } else showNotification(result.error || 'Ошибка при отправке заявки.');
      } catch (error) {
        console.error('Ошибка:', error);
        showNotification('Произошла ошибка.');
      }
    });

    document.getElementById('invest-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const telegram = document.getElementById('invest-telegram').value;
      const message = document.getElementById('invest-message').value;
      const serverUrl = 'https://payshub-feedback-bot.glitch.me/send-message';
      try {
        const response = await fetch(serverUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            telegram,
            message: `Новая заявка на инвестиции:\n\nTelegram: ${telegram}\nСообщение: ${message}\n\nДанные пользователя:\nID: ${telegramId}\nИмя: ${telegramFirstName}\nФамилия: ${telegramLastName}\nUsername: @${telegramUsername || 'Не указан'}`
          })
        });
        const result = await response.json();
        if (response.ok) {
          showNotification('Заявка успешно отправлена!');
          closeInvestPopup();
          document.getElementById('invest-form').reset();
        } else showNotification(result.error || 'Ошибка при отправке заявки.');
      } catch (error) {
        console.error('Ошибка:', error);
        showNotification('Произошла ошибка.');
      }
    });

    document.getElementById('agent-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const telegram = document.getElementById('agent-telegram').value;
      const message = document.getElementById('agent-message').value;
      const serverUrl = 'https://payshub-feedback-bot.glitch.me/send-message';
      try {
        const response = await fetch(serverUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            telegram,
            message: `Новая заявка на участие в партнёрской программе:\n\nTelegram: ${telegram}\nСообщение: ${message}\n\nДанные пользователя:\nID: ${telegramId}\nИмя: ${telegramFirstName}\nФамилия: ${telegramLastName}\nUsername: @${telegramUsername || 'Не указан'}`
          })
        });
        const result = await response.json();
        if (response.ok) {
          showNotification('Заявка успешно отправлена!');
          closeAgentPopup();
          document.getElementById('agent-form').reset();
        } else showNotification(result.error || 'Ошибка при отправке заявки.');
      } catch (error) {
        console.error('Ошибка:', error);
        showNotification('Произошла ошибка.');
      }
    });

    document.addEventListener('click', (e) => {
      if (!e.target.closest('.apply-button') && !e.target.closest('.feedback-popup') && !e.target.closest('.agent-button')) closeFeedbackPopup();
      if (!e.target.closest('.apply-button') && !e.target.closest('.add-psp-popup') && !e.target.closest('.agent-button')) closeAddPspPopup();
      if (!e.target.closest('.apply-button') && !e.target.closest('.invest-popup') && !e.target.closest('.agent-button')) closeInvestPopup();
      if (!e.target.closest('.agent-button') && !e.target.closest('.agent-popup') && !e.target.closest('.apply-button')) closeAgentPopup();
      if (!e.target.closest('.filter-dropdown') && !e.target.closest('.filter-popup')) {
        document.querySelectorAll('.filter-popup').forEach(popup => {
          popup.classList.remove('active');
          document.querySelector('.content-container').classList.remove('blurred');
          document.querySelector('.tabs').classList.remove('blurred');
        });
      }
    });

    window.addEventListener('load', () => {
      const preloader = document.getElementById('preloader');
      setTimeout(() => {
        preloader.classList.add('hidden');
        preloader.addEventListener('transitionend', () => preloader.style.display = 'none', { once: true });
      }, 2000);
      showPrivacyNotice();
      loadData();
      if (!localStorage.getItem('hasVisited')) {
        const serverUrl = 'https://payshub-visits-bot-new.glitch.me/send-visit';
        fetch(serverUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            telegram: `@${telegramUsername}`,
            message: `Новый пользователь зашёл в приложение:\n\nID: ${telegramId}\nИмя: ${telegramFirstName}\nФамилия: ${telegramLastName}\nUsername: @${telegramUsername || 'Не указан'}`
          })
        }).then(response => response.json())
          .then(result => {
            if (response.ok) localStorage.setItem('hasVisited', 'true');
            else console.error('Ошибка при отправке данных пользователя:', result.error);
          })
          .catch(error => console.error('Ошибка при отправке данных пользователя:', error));
      }
    });

    window.addEventListener('resize', adjustContentPadding);

    document.querySelectorAll('.coin').forEach(item => {
      const randomLeft = Math.random() * 90 + 30;
      item.style.left = `${randomLeft}px`;
      item.style.top = '-30px';
    });
  </script>
  <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'92ba42407c4cbfff',t:'MTc0Mzg2ODgzMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>
